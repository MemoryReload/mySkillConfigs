{
  "url": "https://www.csjplatform.com/supportcenter/5379",
  "title": "开屏广告",
  "content": "开发测试/iOS集成文档/开屏广告\n开屏广告\n最近更新 2025-10-14 14:12:12\n简介\n\n开屏广告主要是 APP 启动时展示的全屏广告视图，开发只要按照接入标准就能够展示设计好的视图。展示完毕后自动关闭并进入应用的主界面。\n\n开屏广告使用BUSplashAd对象管理开屏广告所有业务；接入方式上，使用BUSplashAd对象调用loadAdData方法请求广告，调用show方法展示广告，通过设置BUSplashAdDelegate代理，获取广告加载、 渲染、点击、关闭、跳转等回调。\n\n开屏样式接口概览\n创建广告对象、请求广告、展示广告\n\n广告对象创建时必须传入代码位ID：\n\n复制\n//保证每次请求的广告对象为新的广告对象，避免重复使用广告同一个对象进行广告请求\n_splashAd = [[BUSplashAd alloc] initWithSlotID:slotID adSize:size];\n// 设置开屏广告代理\n_splashAd.delegate = self;\n// 加载广告\n[_splashAd loadAdData];\n\n广告物料、素材加载成功后，会回调splashAdLoadSuccess：方法，在这里调用show方法展示广告：\n\n接入方式一（强烈推荐）：\n\n使用App主window对象的根视图控制器展示，不需要管理开屏控制器展示，但6900及以上版本点击广告，SDK将不再主动移除视图，开发者可以根据业务场景自行处理，点击跳过按钮或倒计时结束时仍由SDK进行移除。\n\n示例代码（完整代码可参考官方demo中BUDSplashViewController 类）\n\n展示广告\n\n复制\n- (void)splashAdLoadSuccess:(BUSplashAd *)splashAd {\n    // 使用应用keyWindow的rootViewController（接入简单，推荐）\n    UIWindow *keyWindow = [UIApplication sharedApplication].keyWindow;   \n   [splashAd showSplashViewInRootViewController:keyWindow.rootViewController];\n}\n\n移除广告\n\n开发者根据业务场景需要，使用[splashAd removeSplashView]方式移除广告视图\n\n\n\n\n接入方式二（不推荐）：\n\n开发者如果使用新创建的视图控制器接入，需要自行管理viewController的展示和关闭，同时需要处理广告点击时的视图移除逻辑，点击跳过按钮或倒计时结束仍由SDK进行移除。\n\n示例代码（完整代码可参考官方demo中BUDSplashViewController 类）\n\n展示广告\n\n复制\n@implementation SplashViewController\n\n#pragma mark - BUSplashAdDelegate\n- (void)splashAdLoadSuccess:(BUSplashAd *)splashAd {\n   [splashAd showSplashViewInRootViewController:self];\n}\n\n- (void)splashAdRenderSuccess:(BUSplashAd *)splashAd {\n    // 渲染成功再展示视图控制器\n    UIWindow *keyWindow = [[[UIApplication sharedApplication] delegate] window];\n   [keyWindow.rootViewController addChildViewController:self];\n   [keyWindow.rootViewController.view addSubview:self.view];\n} \n\n@end\n\n移除广告\n\n开发者可在开屏相关代理回调中关闭当前视图控制器，示例代码如下：\n\n复制\n@implementation SplashViewController\n\n#pragma mark - BUSplashAdDelegate\n// 广告物料加载失败回调\n- (void)splashAdLoadFail:(BUSplashAd *)splashAd error:(BUAdError * _Nullable)error {\n   [self p_dismiss];\n}\n\n// 渲染失败回调\n- (void)splashAdRenderFail:(BUSplashAd *)splashAd error:(BUAdError * _Nullable)error {\n   [self p_dismiss];\n}\n\n// 开屏视图关闭回调\n- (void)splashAdDidClose:(BUSplashAd * )splashAd closeType:(BUSplashAdCloseType)closeType {\n  //注意！！！不要在这个回调中关闭控制器，会导致中间页无法跳转\n  // [self p_dismiss]; \n}\n\n// 开屏视图控制器关闭回调\n- (void)splashAdViewControllerDidClose:(BUSplashAd *)splashAd {\n   [self p_dismiss];\n}\n\n#pragma mark - private\n- (void)p_dismiss {\n   [self.view removeFromSuperview];\n   [self removeFromParentViewController];\n}\n\n// 6900及以上版本新增\n\n//外跳型广告：点击广告时，落地页、AppStore页类型的广告展示依赖控制器，该时机不推荐做移除操作，但可以做点击的标记用于移除的判断\n\n- (void)splashAdDidClick:(BUSplashAd *)splashAd {\n    // 该方式接入，如果是落地页、AppStore页类型的广告，展示依赖控制器\n    // 对于deeplink/ulink类型的广告不依赖控制器可以根据类似didClicked标记位直接移除\n    // 开发者需要根据具体情况移除控制器\n    self.didClicked = YES;\n}\n\n// 外跳型广告：切换前后台\n// 监听后台通知 点击标记\n[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(didEnterBackgroundNotification) name:UIApplicationDidEnterBackgroundNotification object:nil];\n\n- (void)didEnterBackgroundNotification {\n    if (self.didClicked) {\n       [self p_dismiss]\n   }\n}\n\n// 中间页类型广告     \n// 关闭落地页或AppStore页面回调\n- (void)splashDidCloseOtherController:(nonnull BUSplashAd *)splashAd interactionType:(BUInteractionType)interactionType {\n   [self p_dismiss];\n}\n超时时长设置\n\n超时的计算逻辑：穿山甲从开发者加载广告开始倒计时（注意并非从SDK初始化开始计时），若广告在倒计时结束之前完成广告加载，则会为开发者响应广告。若倒计时结束前未完成广告加载，则将响应超时。建议开发者:\n\n复制\n_splashAd.tolerateTimeout = 3;\n自定义底部logo设置\n\n开发者可自定义开屏底部View，用于logo展示等个性化设置。\n\n复制\n// 设置半屏尺寸\n\nself.splashFrame = CGRectMake(0, 0, _rootViewController.view.size.width, _rootViewController.view.size.height - 100);\n    \n    _splashAd = [[BUSplashAd alloc] initWithSlotID:self.viewModel.slotID adSize:self.splashFrame.size];\n    // 不支持中途更改代理，中途更改代理会导致接收不到广告相关回调，如若存在中途更改代理场景，需自行处理相关逻辑，确保广告相关回调正常执行。\n    _splashAd.delegate = self;\n    _splashAd.zoomOutDelegate = self;\n    \n    _splashAd.supportZoomOutView = YES;\n    _splashAd.tolerateTimeout = 3;\n\n   [_splashAd loadAdData];\n    \n    // 自定义底部视图\n    _bottomView = [[UIView alloc] initWithFrame:CGRectMake(0, self.splashFrame.size.height, self.splashFrame.size.width, 100)];\n    _bottomView.backgroundColor = [UIColor brownColor];\n\n// 调用展示广告show\n- (void)splashAdLoadSuccess:(nonnull BUSplashAd *)splashAd {\n   [self pbud_logWithSEL:_cmd msg:@\"\\\"];\n    // 使用应用keyWindow的rootViewController（接入简单，推荐）\n   [splashAd showSplashViewInRootViewController:_rootViewController];\n    \n}\n// 添加开屏广告底部logo\n- (void)splashAdRenderSuccess:(nonnull BUSplashAd *)splashAd {\n    if (self.showBottomView) { // 自定义底部视图\n       [splashAd.splashRootViewController.view addSubview:_bottomView];\n   }\n}\n开屏回调说明\n\n时机\n\n\t\n\n方法\n\n\t\n\n说明\n\n\n\n\n广告物料、素材加载成功\n\n\n\n\n\t\n\n- (void)splashAdLoadSuccess:(BUSplashAd *)splashAd;\n\n\n\n\n\t\n\n物料加载成功，可以在这个回调中调用show方法展示开屏\n\n\n\n\n广告物料、素材加载失败\n\n\t\n\n- (void)splashAdLoadFail:(BUSplashAd *)splashAd error:(BUAdError *)error;\n\n\n\n\n\t\n\n物料加载失败，不会展示开屏，提供如下错误码：\n\ntypedef NS_ENUM(NSInteger, BUSplashAdLoadError) {\n\nBUSplashAdLoadError_UnKnow= 0, //未知错误\n\nBUSplashAdLoadError_DataError = 1, // 数据加载失败\n\nBUSplashAdLoadError_TimeOut = 2, // 超时\n\n};\n\n\n\n\n广告渲染成功\n\n\t\n\n- (void)splashAdRenderSuccess:(BUSplashAd *)splashAd;\n\n\t\n\nload方法调用后，若渲染成功则返回该回调；show方法调用后开屏视图会被添加到ViewController上。\n\n\n\n\n广告渲染失败\n\n\t\n\n- (void)splashAdRenderFail:(BUSplashAd *)splashAd error:(BUAdError *)error;\n\n\n\n\n\t\n\nload方法调用后，若渲染失败则返回该回调；即使调用show方法开屏视图也不会被添加到ViewController上，提供如下错误码：\n\ntypedef NS_ENUM(NSInteger, BUSplashAdErrorCode) { CSJSplashAdError_Unknow = 0, CSJSplashAdError_LoadFailed = 1, // 物料加载失败 CSJSplashAdError_ResourceFailed = 2, // 素材加载失败 CSJSplashAdError_RenderFailed = 3, // 渲染失败 CSJSplashAdError_TimeOut = 23 // 超时\n\n };\n\n\n\n\n广告即将展示\n\n\t\n\n- (void)splashAdWillShow:(BUSplashAd * )splashAd;\n\n\t\n\n\n\n\n\n\n\n广告展示\n\n\t\n\n- (void)splashAdDidShow:(BUSplashAd * )splashAd;\n\n\t\n\n注意：该回调时机和show埋点上报时机一致\n\n\n\n\n广告视图关闭\n\n\n\n\n\t\n\n- (void)splashAdDidClose:(BUSplashAd * )splashAd closeType:(BUSplashAdCloseType)closeType；\n\n\n\n\n\n\n\t\n\n广告视图会在以下场景关闭：\n\n1、开屏未转化关闭（点击跳过、倒计时结束），通知开发者开屏视图已经关闭\n\n2、 开屏转化后内开调起市场页，市场页关闭时通知开发者开屏视图已经关闭\n\n3、开屏转化其他场景，点击广告后通知开发者开屏视图已经关闭\n\n其他说明：\n\n1、广告视图关闭后由SDK移除开屏视图\n\n2、closeType标记从哪种场景关闭\n\n复制\nbrtypedef NS_ENUM(NSInteger, BUSplashAdCloseType) {br    BUSplashAdCloseType_Unknow = 0, // 未知br    BUSplashAdCloseType_ClickSkip = 1,  // 点击跳过br    BUSplashAdLoadError_CountdownToZero = 2 , // 倒计时结束br    BUSplashAdCloseType_ClickJump = 3  // 点击跳转br};\n\n\n\n广告视图控制器关闭\n\n\n\n\n\n\n\t\n\n- (void)splashAdViewControllerDidClose:(BUSplashAd *)splashAd;\n\n\n\n\n\t\n\n如果采用自定义视图控制器展示广告，广告视图控制器会在以下场景关闭：\n\n1、开屏未转化关闭（点击跳过、倒计时结束），通知开发者关闭视图控制器\n\n2、开屏转化后内跳，中间页、市场页关闭时，通知开发者关闭视图控制器\n\n3、开屏转化外跳，即将跳转时，通知开发者关闭视图控制器\n\n\n\n\n广告点击\n\n\t\n\n- (void)splashAdDidClick:(BUSplashAd * )splashAd;\n\n\t\n\n\n\n\n\n\n\n广告中间页、市场页面关闭\n\n\t\n\n- (void)splashDidCloseOtherController:(BUSplashAd *)splashAd interactionType:(BUInteractionType)interactionType;\n\n\n\n\n\t\n\n此回调在广告跳转到其他控制器时，该控制器被关闭时调用。\n\ninteractionType：此参数可区分是打开的appstore/网页/视频广告详情页面\n\n\n\n\n视频广告播放完毕\n\n\t\n\n- (void)splashVideoAdDidPlayFinish:(BUSplashAd *)splashAd didFailWithError:(NSError *)error;\n\n\t\n\n\n\n\n接入须知\n\n1、自渲染&模板渲染 rit位：新版本不区分渲染方式的rit位\n\n2、开屏内部相关的视图生命周期由SDK管理，开发者关注BUSplashAd对象。当BUSplashAd被非法释放时，开屏内部视图会被同时移除释放。\n\n3、接入开屏的最佳实践，在loadSuccess回调中调用show方法展示广告。\n\n4、开屏视图关闭后，splashView即被释放（nil），如在开屏结束后依赖开屏视图做动画，可以使用splashViewSnapshot对象。\n\n5、rootViewController建议使用应用当前window对象的rootViewController(keyWindow.rootViewController)或者当前视图控制器的根控制器navigationController（viewController.navigationController）。如果使用新创建的viewController，注意在开屏广告视图控制器关闭回调中splashAdViewControllerDidClose:从当前控制器堆栈中移除viewController：\n\n复制\n// 开屏视图控制器关闭回调（4.7.0.3新增回调）\n- (void)splashAdViewControllerDidClose:(BUSplashAd *)splashAd {\n   [viewController.view removeFromSuperview];\n   [viewController removeFromParentViewController];\n}\n\n6、loadAdData方法不是线程安全的，请尽量在主线程调用。\n\n\n\n\n本篇目录\n简介\n开屏样式接口概览\n创建广告对象、请求广告、展示广告\n超时时长设置\n自定义底部logo设置\n开屏回调说明\n接入须知\n评价此篇文档\n有帮助\n无帮助"
}