{
  "url": "https://www.csjplatform.com/supportcenter/5378",
  "title": "SDK初始化及全局配置",
  "content": "开发测试/iOS集成文档/SDK初始化及全局配置\nSDK初始化及全局配置\n最近更新 2025-09-17 13:24:00\n注意事项\nBUAdSDKManager 类是整个 SDK 设置的入口和接口，可以设置 SDK 的一些全局信息，提供类方法获取设置结果。\nsetIsPaidApp:和setUserKeywords:须征得用户同意才可传入。\n任意广告类型均不支持中途更改代理，中途更改代理会导致接收不到广告相关回调，如若存在中途更改代理场景，需自行处理相关逻辑，确保广告相关回调正常执行。\n接入过程中，强烈建议双端分别使用各自的应用ID进行测试，不要混用，否则可能会影响收益。\n接口说明\n\n目前接口提供以下几个类方法：\n\n复制\n@property (nonatomic, copy, readonly, class) NSString *SDKVersion;\n\n//同时集成穿山甲SDK和Pangle SDK需要设置此接口，5205及以上版本该接口下线，开发者不需要设置\n@property (nonatomic, assign) BUAdSDKTerritory territory;\n\n//应用ID\n@property (nonatomic, copy) NSString *appID;\n\n//应用的唯一标识，可选参数\n@property (nonatomic, copy) NSString *secretKey;\n\n//配置开发模式。默认BUAdSDKLogLevelNone\n@property (nonatomic, assign) BUAdSDKLogLevel logLevel;\n\n//用户年龄设置\n@property (nonatomic, assign) BUAdSDKAgeGroup ageGroup;\n\n//用户的其他信息\n@property (nonatomic, copy) NSString *userExtData;\n\n//默认 BUOfflineTypeWebview\n@property (nonatomic, assign) BUOfflineType webViewOfflineType;\n\n//打印调试日志，0关闭调试日志； 1打开调试日志\n@property (nonatomic, strong) NSNumber *debugLog;\n\n//主题模式\n@property (nonatomic, strong) NSNumber *themeStatus;\n\n//自定义设置用户AB实验 \n@property (nonatomic, strong) NSArray<NSNumber *> *abvids;\n\n//用户自定义设置AB SDK版本\n@property (atomic, copy) NSString *abSDKVersion;\n\n//自定义idfa\n@property (nonatomic, copy) NSString *customIdfa;\n\n//是否允许SDK在播放音频时修改AVAudioSession的类别和选项，默认为NO。SDK设置的类别是AVAudioSessionCategoryAmbient，开发者可以自行设置为AVAudioSessionCategoryOptionDuckOthers\n@property (nonatomic, assign) BOOL allowModifyAudioSessionSetting;\n\n// BUAudioSessionSettingType_Mix = 3  可以跟其他音乐软件共存声音 \n// BUAudioSessionSettingType_Default = 0 不支持混音\n// 6204及以上版本支持\n@property (nonatomic, assign) BUAudioSessionSettingType audioSessionSetType;\n\n//unity开发者，设置为YES\n@property (nonatomic, assign) BOOL unityDeveloper;\n\n//隐私数据设置，建议不设置该参数\n@property (nonatomic, strong) id<BUAdSDKPrivacyProvider> privacyProvider;\n\n//logo图标设置\n@property (nonatomic, strong, nullable) UIImage *appLogoImage;\n\n\n//调试模式设置为NO\n@property (nonatomic, assign) BOOL SDKDEBUG;\n\n//隐私数据设置  \n@property (nonatomic, strong, nullable) id<BUAdSDKPrivacyProvider> privacyProvider;\n\n\n//3600版本开始，新增SDK初始化状态回调\n[BUAdSDKManager startWithAsyncCompletionHandler:^(BOOL success, NSError *error) {\n   if (success) { /// }\n     }];\n\n使用详情\n\n强烈建议在用户同意隐私协议后再进行SDK的初始化操作，其中seAppID设置是必须的\n\n//3500及以上版本SDK初始化说明\n\n复制\nBUAdSDKConfiguration *configuration = [BUAdSDKConfiguration configuration];\n    configuration.territory = BUAdSDKTerritory_CN;\n    configuration.appID = @\"xxxxxx\";//除appid外，其他参数配置按照项目实际需求配置即可。\n   [BUAdSDKManager startWithAsyncCompletionHandler:^(BOOL success, NSError *error) {\n        if (success) {\n           dispatch_async(dispatch_get_main_queue(), ^{\n         //请求广告逻辑处理\n           \n           });\n       }\n   }]; \n\n//3500以下版本SDK初始化说明\n\n复制\n[BUAdSDKManager setAppID:@\"xxxxxx\"];//57xx版本正式下线\n\n更多使用方式可以参见 SDK Demo 工程\n\n日志输出说明\n复制\n// 日志输出枚举值详情\ntypedef NS_ENUM(NSInteger, BUAdSDKLogLevel) {\n    BUAdSDKLogLevelNone,\n    BUAdSDKLogLevelError,\n    BUAdSDKLogLevelWarning,\n    BUAdSDKLogLevelInfo,\n    BUAdSDKLogLevelDebug,\n    BUAdSDKLogLevelVerbose,\n};\n\n3500及以上版本说明\n\n复制\nBUAdSDKConfiguration *configuration = [BUAdSDKConfiguration configuration];\nconfiguration.logLevel = BUAdSDKLogLevelDebug;\n\n3500以下版本说明\n\n复制\n/// Whether to open log. default is none.\n[BUAdSDKManager setLoglevel:BUAdSDKLogLevelDebug];\n\n\n\n\nIDFA使用说明\n\n7200及以上版本说明\n\n复制\n//复用BUAdSDKPrivacyProvider中的方法:-(nullable NSDictionary*)privacyConfig\n- (NSDictionary *)privacyConfig {\n    NSMutableDictionary *privacy = [NSMutableDictionary dictionary];\n    // motion_info表示是否允许传感器采集数据，默认不传时允许采集\n    // \\\"0\\\": 不允许\n    // \\\"1\\\": 允许\n    // 其他值或不实现该协议方法认为允许采集\n   [privacy setObject:@\"1\" forKey:@\"motion_info\"];\n\n    // forbidden_idfa表示是否禁止idfa采集，\\\"1\\\"表示禁止\n   [privacy setObject:@\"0\" forKey:@\"forbidden_idfa\"];\n\n    return [privacy copy];\n}\n\n\n\n\n自定义IDFA说明\n\n3500及以上版本说明\n\n复制\nBUAdSDKConfiguration *configuration = [BUAdSDKConfiguration configuration];\nconfiguration.customIdfa = @\"12345678-1234-1234-1234-123456789012\"\n\n3500以下版本说明\n\n复制\n[BUAdSDKManager setCustomIDFA:@\"12345678-1234-1234-1234-123456789012\"];\n广告跳过设置\n\n广告接口中的所有rootViewController均为必传项，用来处理广告跳转。SDK里所有的跳转均采用present的方式，请确保传入的rootViewController不能为空且没有present其他的控制器，否则会出现presentedViewController已经存在而导致present失败。\n\n隐私协议\nBUAdSDKConfiguration 新增 privacyProvider 参数，用来让开发者控制某些隐私字段的启用或传值。这个字段只对国内有效，国外设置无反应。\n复制\n/// You can use this property to set whether the SDK can use certain privacy data, or pass these privacy data yourself.\n/// If this property is not set, the SDK will execute the default privacy data usage logic.\n/// Note: This property is only valid for the CN environment. Unless you know what you need, it is recommended not to assign a value to this property.\n@property (nonatomic, strong) id<BUAdSDKPrivacyProvider> privacyProvider;\n\n\n/// Provide a protocol for custom private data\n/// Only valid in the CN environment\n@protocol BUAdSDKPrivacyProvider <NSObject data-tomark-pass >\n\n@optional\n\n/// Specify whether to allow the SDK to use location data\n- (BOOL)canUseLocation;\n/// Return a latitude value\n- (CLLocationDegrees)latitude;\n/// Return a longitude value\n- (CLLocationDegrees)longitude;\n夜间模式\n\n3600版本开始，穿山甲支持开发者在使用模板渲染信息流&插屏&Banner广告时设置夜间模式的功能\n\n复制\nBUAdSDKManager 或 BUAdSDKConfiguration类中\n\n  // 枚举值类型\n    typedefNS_ENUM(NSInteger, BUAdSDKThemeStatus) {\n       BUAdSDKThemeStatus_Normal = 0,   // 正常模式\n       BUAdSDKThemeStatus_Night= 1,     // 夜间模式\n      };\n\n      // 若开发者未设置，那么默认值是 Normal， 如果开发者设置的为非法值，会强行修改为  Normal\n       + (void)setThemeStatus:(BUAdSDKThemeStatus)themeStatus;\n\n  // 获取当前主题类型\n       + (BUAdSDKThemeStatus)themeStatus;\n混音设置\n复制\n   BUAdSDKConfiguration *configuration = [BUAdSDKConfiguration configuration];\n    configuration.appID = [BUDAdManager appKey];\n    configuration.privacyProvider = [[BUDPrivacyProvider alloc] init];\n    configuration.appLogoImage = [UIImage imageNamed:@\"AppIcon\"];\n    configuration.debugLog = @(1);\n    configuration.allowModifyAudioSessionSetting = YES;\n    //设置这个可以让后台音乐跟广告声音共存\n    configuration.audioSessionSetType = BUAudioSessionSettingType_Mix; //可以跟其他音乐软件共存声音\n\n\n\n\n本篇目录\n注意事项\n接口说明\n使用详情\n日志输出说明\nIDFA使用说明\n自定义IDFA说明\n广告跳过设置\n隐私协议\n夜间模式\n混音设置\n评价此篇文档\n有帮助\n无帮助"
}