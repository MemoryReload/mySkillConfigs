{
  "title": "Use the uploaded file in a message",
  "content": "message = client.beta.messages.create(\n    model=\"claude-sonnet-4-5\",\n    max_tokens=1024,\n    betas=[\"files-api-2025-04-14\"],\n    messages=[\n        {\n            \"role\": \"user\",\n            \"content\": [\n                {\n                    \"type\": \"image\",\n                    \"source\": {\n                        \"type\": \"file\",\n                        \"file_id\": file_upload.id\n                    }\n                },\n                {\n                    \"type\": \"text\",\n                    \"text\": \"Describe this image.\"\n                }\n            ]\n        }\n    ],\n)\n\nprint(message.content)\ntypescript TypeScript\nimport { Anthropic, toFile } from '@anthropic-ai/sdk';\nimport fs from 'fs';\n\nconst anthropic = new Anthropic();\n\nasync function main() {\n  // Upload the image file\n  const fileUpload = await anthropic.beta.files.upload({\n    file: toFile(fs.createReadStream('image.jpg'), undefined, { type: \"image/jpeg\" })\n  }, {\n    betas: ['files-api-2025-04-14']\n  });\n\n// Use the uploaded file in a message\n  const response = await anthropic.beta.messages.create({\n    model: 'claude-sonnet-4-5',\n    max_tokens: 1024,\n    betas: ['files-api-2025-04-14'],\n    messages: [\n      {\n        role: 'user',\n        content: [\n          {\n            type: 'image',\n            source: {\n              type: 'file',\n              file_id: fileUpload.id\n            }\n          },\n          {\n            type: 'text',\n            text: 'Describe this image.'\n          }\n        ]\n      }\n    ]\n  });\n\nconsole.log(response);\n}\n\nmain();\njava Java\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.nio.file.Path;\nimport java.util.List;\n\nimport com.anthropic.client.AnthropicClient;\nimport com.anthropic.client.okhttp.AnthropicOkHttpClient;\nimport com.anthropic.models.File;\nimport com.anthropic.models.files.FileUploadParams;\nimport com.anthropic.models.messages.*;\n\npublic class ImageFilesExample {\n    public static void main(String[] args) throws IOException {\n        AnthropicClient client = AnthropicOkHttpClient.fromEnv();\n\n// Upload the image file\n        File file = client.beta().files().upload(FileUploadParams.builder()\n                .file(Files.newInputStream(Path.of(\"image.jpg\")))\n                .build());\n\n// Use the uploaded file in a message\n        ImageBlockParam imageParam = ImageBlockParam.builder()\n                .fileSource(file.id())\n                .build();\n\nMessageCreateParams params = MessageCreateParams.builder()\n                .model(Model.CLAUDE_SONNET_4_5_LATEST)\n                .maxTokens(1024)\n                .addUserMessageOfBlockParams(\n                        List.of(\n                                ContentBlockParam.ofImage(imageParam),\n                                ContentBlockParam.ofText(\n                                        TextBlockParam.builder()\n                                                .text(\"Describe this image.\")\n                                                .build()\n                                )\n                        )\n                )\n                .build();\n\nMessage message = client.messages().create(params);\n        System.out.println(message.content());\n    }\n}\npython Python\n    message = client.messages.create(\n        model=\"claude-sonnet-4-5\",\n        max_tokens=1024,\n        messages=[\n            {\n                \"role\": \"user\",\n                \"content\": [\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"base64\",\n                            \"media_type\": image1_media_type,\n                            \"data\": image1_data,\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Describe this image.\"\n                    }\n                ],\n            }\n        ],\n    )\n    python Python\n    message = client.messages.create(\n        model=\"claude-sonnet-4-5\",\n        max_tokens=1024,\n        messages=[\n            {\n                \"role\": \"user\",\n                \"content\": [\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"url\",\n                            \"url\": \"https://upload.wikimedia.org/wikipedia/commons/a/a7/Camponotus_flavomarginatus_ant.jpg\",\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Describe this image.\"\n                    }\n                ],\n            }\n        ],\n    )\n    python Python\n    message = client.messages.create(\n        model=\"claude-sonnet-4-5\",\n        max_tokens=1024,\n        messages=[\n            {\n                \"role\": \"user\",\n                \"content\": [\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 1:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"base64\",\n                            \"media_type\": image1_media_type,\n                            \"data\": image1_data,\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 2:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"base64\",\n                            \"media_type\": image2_media_type,\n                            \"data\": image2_data,\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"How are these images different?\"\n                    }\n                ],\n            }\n        ],\n    )\n    python Python\n    message = client.messages.create(\n        model=\"claude-sonnet-4-5\",\n        max_tokens=1024,\n        messages=[\n            {\n                \"role\": \"user\",\n                \"content\": [\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 1:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"url\",\n                            \"url\": \"https://upload.wikimedia.org/wikipedia/commons/a/a7/Camponotus_flavomarginatus_ant.jpg\",\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 2:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"url\",\n                            \"url\": \"https://upload.wikimedia.org/wikipedia/commons/b/b5/Iridescent.green.sweat.bee1.jpg\",\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"How are these images different?\"\n                    }\n                ],\n            }\n        ],\n    )\n    python Python\n    message = client.messages.create(\n        model=\"claude-sonnet-4-5\",\n        max_tokens=1024,\n        system=\"Respond only in Spanish.\",\n        messages=[\n            {\n                \"role\": \"user\",\n                \"content\": [\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 1:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"base64\",\n                            \"media_type\": image1_media_type,\n                            \"data\": image1_data,\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 2:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"base64\",\n                            \"media_type\": image2_media_type,\n                            \"data\": image2_data,\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"How are these images different?\"\n                    }\n                ],\n            }\n        ],\n    )\n    python Python\n    message = client.messages.create(\n        model=\"claude-sonnet-4-5\",\n        max_tokens=1024,\n        system=\"Respond only in Spanish.\",\n        messages=[\n            {\n                \"role\": \"user\",\n                \"content\": [\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 1:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"url\",\n                            \"url\": \"https://upload.wikimedia.org/wikipedia/commons/a/a7/Camponotus_flavomarginatus_ant.jpg\",\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"Image 2:\"\n                    },\n                    {\n                        \"type\": \"image\",\n                        \"source\": {\n                            \"type\": \"url\",\n                            \"url\": \"https://upload.wikimedia.org/wikipedia/commons/b/b5/Iridescent.green.sweat.bee1.jpg\",\n                        },\n                    },\n                    {\n                        \"type\": \"text\",\n                        \"text\": \"How are these images different?\"\n                    }\n                ],\n            }\n        ],\n    )\n    json\n  {\n    \"type\": \"image\",\n    \"source\": {\n      \"type\": \"url\",\n      \"url\": \"https://upload.wikimedia.org/wikipedia/commons/a/a7/Camponotus_flavomarginatus_ant.jpg\"\n    }\n  }\n  ```\n\n<section title=\"Is there a limit to the image file size I can upload?\">\n\nYes, there are limits:\n    - API: Maximum 5MB per image\n    - claude.ai: Maximum 10MB per image\n\nImages larger than these limits will be rejected and return an error when using our API.\n\n<section title=\"How many images can I include in one request?\">\n\nThe image limits are:\n    - Messages API: Up to 100 images per request\n    - claude.ai: Up to 20 images per turn\n\nRequests exceeding these limits will be rejected and return an error.\n\n<section title=\"Does Claude read image metadata?\">\n\nNo, Claude does not parse or receive any metadata from images passed to it.\n\n<section title=\"Can I delete images I've uploaded?\">\n\nNo. Image uploads are ephemeral and not stored beyond the duration of the API\n  request. Uploaded images are automatically deleted after they have been\n  processed.\n\n<section title=\"Where can I find details on data privacy for image uploads?\">\n\nPlease refer to our privacy policy page for information on how we handle\n  uploaded images and other data. We do not use uploaded images to train our\n  models.\n\n<section title=\"What if Claude's image interpretation seems wrong?\">\n\nIf Claude's image interpretation seems incorrect:\n    1. Ensure the image is clear, high-quality, and correctly oriented.\n    2. Try prompt engineering techniques to improve results.\n    3. If the issue persists, flag the output in claude.ai (thumbs up/down) or contact our support team.\n\nYour feedback helps us improve!\n\n<section title=\"Can Claude generate or edit images?\">\n\nNo, Claude is an image understanding model only. It can interpret and analyze images, but it cannot generate, produce, edit, manipulate, or create images.\n  \n</section>\n\n## Dive deeper into vision\n\nReady to start building with images using Claude? Here are a few helpful resources:\n\n- [Multimodal cookbook](https://platform.claude.com/cookbook/multimodal-getting-started-with-vision): This cookbook has tips on [getting started with images](https://platform.claude.com/cookbook/multimodal-getting-started-with-vision) and [best practice techniques](https://platform.claude.com/cookbook/multimodal-best-practices-for-vision) to ensure the highest quality performance with images. See how you can effectively prompt Claude with images to carry out tasks such as [interpreting and analyzing charts](https://platform.claude.com/cookbook/multimodal-reading-charts-graphs-powerpoints) or [extracting content from forms](https://platform.claude.com/cookbook/multimodal-how-to-transcribe-text).\n- [API reference](/docs/en/api/messages): Visit our documentation for the Messages API, including example [API calls involving images](/docs/en/build-with-claude/working-with-messages#vision).\n\nIf you have any other questions, feel free to reach out to our [support team](https://support.claude.com/). You can also join our [developer community](https://www.anthropic.com/discord) to connect with other creators and get help from Anthropic experts.",
  "code_samples": [
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "</CodeGroup>\n\nSee [Messages API examples](/docs/en/api/messages) for more example code and parameter details.\n\n<section title=\"Example: One image\">\n\nIt’s best to place images earlier in the prompt than questions about them or instructions for tasks that use them.\n\nAsk Claude to describe one image.\n\n| Role | Content                        |\n| ---- | ------------------------------ |\n| User | \\[Image\\] Describe this image. |\n\n<Tabs>\n  <Tab title=\"Using Base64\">",
      "language": "unknown"
    },
    {
      "code": "</Tab>\n  <Tab title=\"Using URL\">",
      "language": "unknown"
    },
    {
      "code": "</Tab>\n</Tabs>\n\n</section>\n<section title=\"Example: Multiple images\">\n\nIn situations where there are multiple images, introduce each image with `Image 1:` and `Image 2:` and so on. You don’t need newlines between images or between images and the prompt.\n\nAsk Claude to describe the differences between multiple images.\n| Role | Content |\n| ---- | ------------------------------------------------------------------------- |\n| User | Image 1: \\[Image 1\\] Image 2: \\[Image 2\\] How are these images different? |\n\n<Tabs>\n  <Tab title=\"Using Base64\">",
      "language": "unknown"
    },
    {
      "code": "</Tab>\n  <Tab title=\"Using URL\">",
      "language": "unknown"
    },
    {
      "code": "</Tab>\n</Tabs>\n\n</section>\n<section title=\"Example: Multiple images with a system prompt\">\n\nAsk Claude to describe the differences between multiple images, while giving it a system prompt for how to respond.\n\n| Content |                                                                           |\n| ------- | ------------------------------------------------------------------------- |\n| System  | Respond only in Spanish.                                                  |\n| User    | Image 1: \\[Image 1\\] Image 2: \\[Image 2\\] How are these images different? |\n\n<Tabs>\n  <Tab title=\"Using Base64\">",
      "language": "unknown"
    },
    {
      "code": "</Tab>\n  <Tab title=\"Using URL\">",
      "language": "unknown"
    },
    {
      "code": "</Tab>\n</Tabs>\n\n</section>\n<section title=\"Example: Four images across two conversation turns\">\n\nClaude’s vision capabilities shine in multimodal conversations that mix images and text. You can have extended back-and-forth exchanges with Claude, adding new images or follow-up questions at any point. This enables powerful workflows for iterative image analysis, comparison, or combining visuals with other knowledge.\n\nAsk Claude to contrast two images, then ask a follow-up question comparing the first images to two new images.\n| Role | Content |\n| --------- | ------------------------------------------------------------------------------------ |\n| User | Image 1: \\[Image 1\\] Image 2: \\[Image 2\\] How are these images different? |\n| Assistant | \\[Claude's response\\] |\n| User | Image 1: \\[Image 3\\] Image 2: \\[Image 4\\] Are these images similar to the first two? |\n| Assistant | \\[Claude's response\\] |\n\nWhen using the API, simply insert new images into the array of Messages in the `user` role as part of any standard [multiturn conversation](/docs/en/api/messages) structure.\n\n</section>\n\n---\n\n## Limitations\n\nWhile Claude's image understanding capabilities are cutting-edge, there are some limitations to be aware of:\n\n- **People identification**: Claude [cannot be used](https://www.anthropic.com/legal/aup) to identify (i.e., name) people in images and will refuse to do so.\n- **Accuracy**: Claude may hallucinate or make mistakes when interpreting low-quality, rotated, or very small images under 200 pixels.\n- **Spatial reasoning**: Claude's spatial reasoning abilities are limited. It may struggle with tasks requiring precise localization or layouts, like reading an analog clock face or describing exact positions of chess pieces.\n- **Counting**: Claude can give approximate counts of objects in an image but may not always be precisely accurate, especially with large numbers of small objects.\n- **AI generated images**: Claude does not know if an image is AI-generated and may be incorrect if asked. Do not rely on it to detect fake or synthetic images.\n- **Inappropriate content**: Claude will not process inappropriate or explicit images that violate our [Acceptable Use Policy](https://www.anthropic.com/legal/aup).\n- **Healthcare applications**: While Claude can analyze general medical images, it is not designed to interpret complex diagnostic scans such as CTs or MRIs. Claude's outputs should not be considered a substitute for professional medical advice or diagnosis.\n\nAlways carefully review and verify Claude's image interpretations, especially for high-stakes use cases. Do not use Claude for tasks requiring perfect precision or sensitive image analysis without human oversight.\n\n---\n\n## FAQ\n\n  <section title=\"What image file types does Claude support?\">\n\n    Claude currently supports JPEG, PNG, GIF, and WebP image formats, specifically:\n    - `image/jpeg`\n    - `image/png`\n    - `image/gif`\n    - `image/webp`\n  \n</section>\n\n{\" \"}\n\n<section title=\"Can Claude read image URLs?\">\n\n  Yes, Claude can now process images from URLs with our URL image source blocks in the API.\n  Simply use the \"url\" source type instead of \"base64\" in your API requests. \n  Example:",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Limitations",
      "id": "limitations"
    },
    {
      "level": "h2",
      "text": "FAQ",
      "id": "faq"
    },
    {
      "level": "h2",
      "text": "Dive deeper into vision",
      "id": "dive-deeper-into-vision"
    },
    {
      "level": "h3",
      "text": "Tools",
      "id": "tools"
    }
  ],
  "url": "llms-txt#use-the-uploaded-file-in-a-message",
  "links": []
}