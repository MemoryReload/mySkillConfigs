{
  "title": "Web search tool",
  "content": "The web search tool gives Claude direct access to real-time web content, allowing it to answer questions with up-to-date information beyond its knowledge cutoff. Claude automatically cites sources from search results as part of its answer.\n\n<Note>\nPlease reach out through our [feedback form](https://forms.gle/sWjBtsrNEY2oKGuE8) to share your experience with the web search tool.\n</Note>\n\nWeb search is available on:\n\n- Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`)\n- Claude Sonnet 4 (`claude-sonnet-4-20250514`)\n- Claude Sonnet 3.7 ([deprecated](/docs/en/about-claude/model-deprecations)) (`claude-3-7-sonnet-20250219`)\n- Claude Haiku 4.5 (`claude-haiku-4-5-20251001`)\n- Claude Haiku 3.5 ([deprecated](/docs/en/about-claude/model-deprecations)) (`claude-3-5-haiku-latest`)\n- Claude Opus 4.5 (`claude-opus-4-5-20251101`)\n- Claude Opus 4.1 (`claude-opus-4-1-20250805`)\n- Claude Opus 4 (`claude-opus-4-20250514`)\n\n## How web search works\n\nWhen you add the web search tool to your API request:\n\n1. Claude decides when to search based on the prompt.\n2. The API executes the searches and provides Claude with the results. This process may repeat multiple times throughout a single request.\n3. At the end of its turn, Claude provides a final response with cited sources.\n\n## How to use web search\n\n<Note>\nYour organization's administrator must enable web search in [Console](/settings/privacy).\n</Note>\n\nProvide the web search tool in your API request:\n\nThe web search tool supports the following parameters:\n\nThe `max_uses` parameter limits the number of searches performed. If Claude attempts more searches than allowed, the `web_search_tool_result` will be an error with the `max_uses_exceeded` error code.\n\n#### Domain filtering\n\nWhen using domain filters:\n\n- Domains should not include the HTTP/HTTPS scheme (use `example.com` instead of `https://example.com`)\n- Subdomains are automatically included (`example.com` covers `docs.example.com`)\n- Specific subdomains restrict results to only that subdomain (`docs.example.com` returns only results from that subdomain, not from `example.com` or `api.example.com`)\n- Subpaths are supported and match anything after the path (`example.com/blog` matches `example.com/blog/post-1`)\n- You can use either `allowed_domains` or `blocked_domains`, but not both in the same request.\n\n**Wildcard support:**\n\n- Only one wildcard (`*`) is allowed per domain entry, and it must appear after the domain part (in the path)\n- Valid: `example.com/*`, `example.com/*/articles`\n- Invalid: `*.example.com`, `ex*.com`, `example.com/*/news/*`\n\nInvalid domain formats will return an `invalid_tool_input` tool error.\n\n<Note>\nRequest-level domain restrictions must be compatible with organization-level domain restrictions configured in the Console. Request-level domains can only further restrict domains, not override or expand beyond the organization-level list. If your request includes domains that conflict with organization settings, the API will return a validation error.\n</Note>\n\nThe `user_location` parameter allows you to localize search results based on a user's location.\n\n- `type`: The type of location (must be `approximate`)\n- `city`: The city name\n- `region`: The region or state\n- `country`: The country\n- `timezone`: The [IANA timezone ID](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones).\n\nHere's an example response structure:\n\nSearch results include:\n\n- `url`: The URL of the source page\n- `title`: The title of the source page\n- `page_age`: When the site was last updated\n- `encrypted_content`: Encrypted content that must be passed back in multi-turn conversations for citations\n\nCitations are always enabled for web search, and each `web_search_result_location` includes:\n\n- `url`: The URL of the cited source\n- `title`: The title of the cited source\n- `encrypted_index`: A reference that must be passed back for multi-turn conversations.\n- `cited_text`: Up to 150 characters of the cited content\n\nThe web search citation fields `cited_text`, `title`, and `url` do not count towards input or output token usage.\n\n<Note>\n  When displaying API outputs directly to end users, citations must be included to the original source. If you are making modifications to API outputs, including by reprocessing and/or combining them with your own material before displaying them to end users, display citations as appropriate based on consultation with your legal team.\n</Note>\n\nWhen the web search tool encounters an error (such as hitting rate limits), the Claude API still returns a 200 (success) response. The error is represented within the response body using the following structure:\n\nThese are the possible error codes:\n\n- `too_many_requests`: Rate limit exceeded\n- `invalid_input`: Invalid search query parameter\n- `max_uses_exceeded`: Maximum web search tool uses exceeded\n- `query_too_long`: Query exceeds maximum length\n- `unavailable`: An internal error occurred\n\n#### `pause_turn` stop reason\n\nThe response may include a `pause_turn` stop reason, which indicates that the API paused a long-running turn. You may provide the response back as-is in a subsequent request to let Claude continue its turn, or modify the content if you wish to interrupt the conversation.\n\nWeb search works with [prompt caching](/docs/en/build-with-claude/prompt-caching). To enable prompt caching, add at least one `cache_control` breakpoint in your request. The system will automatically cache up until the last `web_search_tool_result` block when executing the tool.\n\nFor multi-turn conversations, set a `cache_control` breakpoint on or after the last `web_search_tool_result` block to reuse cached content.\n\nFor example, to use prompt caching with web search for a multi-turn conversation:\n\n<CodeGroup>\n```python\nimport anthropic\n\nclient = anthropic.Anthropic()",
  "code_samples": [
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "</CodeGroup>\n\n### Tool definition\n\nThe web search tool supports the following parameters:",
      "language": "unknown"
    },
    {
      "code": "#### Max uses\n\nThe `max_uses` parameter limits the number of searches performed. If Claude attempts more searches than allowed, the `web_search_tool_result` will be an error with the `max_uses_exceeded` error code.\n\n#### Domain filtering\n\nWhen using domain filters:\n\n- Domains should not include the HTTP/HTTPS scheme (use `example.com` instead of `https://example.com`)\n- Subdomains are automatically included (`example.com` covers `docs.example.com`)\n- Specific subdomains restrict results to only that subdomain (`docs.example.com` returns only results from that subdomain, not from `example.com` or `api.example.com`)\n- Subpaths are supported and match anything after the path (`example.com/blog` matches `example.com/blog/post-1`)\n- You can use either `allowed_domains` or `blocked_domains`, but not both in the same request.\n\n**Wildcard support:**\n\n- Only one wildcard (`*`) is allowed per domain entry, and it must appear after the domain part (in the path)\n- Valid: `example.com/*`, `example.com/*/articles`\n- Invalid: `*.example.com`, `ex*.com`, `example.com/*/news/*`\n\nInvalid domain formats will return an `invalid_tool_input` tool error.\n\n<Note>\nRequest-level domain restrictions must be compatible with organization-level domain restrictions configured in the Console. Request-level domains can only further restrict domains, not override or expand beyond the organization-level list. If your request includes domains that conflict with organization settings, the API will return a validation error.\n</Note>\n\n#### Localization\n\nThe `user_location` parameter allows you to localize search results based on a user's location.\n\n- `type`: The type of location (must be `approximate`)\n- `city`: The city name\n- `region`: The region or state\n- `country`: The country\n- `timezone`: The [IANA timezone ID](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones).\n\n### Response\n\nHere's an example response structure:",
      "language": "unknown"
    },
    {
      "code": "#### Search results\n\nSearch results include:\n\n- `url`: The URL of the source page\n- `title`: The title of the source page\n- `page_age`: When the site was last updated\n- `encrypted_content`: Encrypted content that must be passed back in multi-turn conversations for citations\n\n#### Citations\n\nCitations are always enabled for web search, and each `web_search_result_location` includes:\n\n- `url`: The URL of the cited source\n- `title`: The title of the cited source\n- `encrypted_index`: A reference that must be passed back for multi-turn conversations.\n- `cited_text`: Up to 150 characters of the cited content\n\nThe web search citation fields `cited_text`, `title`, and `url` do not count towards input or output token usage. \n\n<Note>\n  When displaying API outputs directly to end users, citations must be included to the original source. If you are making modifications to API outputs, including by reprocessing and/or combining them with your own material before displaying them to end users, display citations as appropriate based on consultation with your legal team.\n</Note>\n\n#### Errors\n\nWhen the web search tool encounters an error (such as hitting rate limits), the Claude API still returns a 200 (success) response. The error is represented within the response body using the following structure:",
      "language": "unknown"
    },
    {
      "code": "These are the possible error codes:\n\n- `too_many_requests`: Rate limit exceeded\n- `invalid_input`: Invalid search query parameter\n- `max_uses_exceeded`: Maximum web search tool uses exceeded\n- `query_too_long`: Query exceeds maximum length\n- `unavailable`: An internal error occurred\n\n#### `pause_turn` stop reason\n\nThe response may include a `pause_turn` stop reason, which indicates that the API paused a long-running turn. You may provide the response back as-is in a subsequent request to let Claude continue its turn, or modify the content if you wish to interrupt the conversation.\n\n## Prompt caching\n\nWeb search works with [prompt caching](/docs/en/build-with-claude/prompt-caching). To enable prompt caching, add at least one `cache_control` breakpoint in your request. The system will automatically cache up until the last `web_search_tool_result` block when executing the tool.\n\nFor multi-turn conversations, set a `cache_control` breakpoint on or after the last `web_search_tool_result` block to reuse cached content.\n\nFor example, to use prompt caching with web search for a multi-turn conversation:\n\n<CodeGroup>",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Supported models",
      "id": "supported-models"
    },
    {
      "level": "h2",
      "text": "How web search works",
      "id": "how-web-search-works"
    },
    {
      "level": "h2",
      "text": "How to use web search",
      "id": "how-to-use-web-search"
    },
    {
      "level": "h3",
      "text": "Tool definition",
      "id": "tool-definition"
    },
    {
      "level": "h3",
      "text": "Response",
      "id": "response"
    },
    {
      "level": "h2",
      "text": "Prompt caching",
      "id": "prompt-caching"
    }
  ],
  "url": "llms-txt#web-search-tool",
  "links": []
}