{
  "title": "Subagents in the SDK",
  "content": "Define and invoke subagents to isolate context, run tasks in parallel, and apply specialized instructions in your Claude Agent SDK applications.\n\nSubagents are separate agent instances that your main agent can spawn to handle focused subtasks.\nUse subagents to isolate context for focused subtasks, run multiple analyses in parallel, and apply specialized instructions without bloating the main agent's prompt.\n\nThis guide explains how to define and use subagents in the SDK using the `agents` parameter.\n\nYou can create subagents in three ways:\n\n- **Programmatically**: use the `agents` parameter in your `query()` options ([TypeScript](/docs/en/agent-sdk/typescript#agentdefinition), [Python](/docs/en/agent-sdk/python#agentdefinition))\n- **Filesystem-based**: define agents as markdown files in `.claude/agents/` directories (see the [Claude Code documentation](https://code.claude.com/docs/en/sub-agents))\n- **Built-in general-purpose**: Claude can invoke the built-in `general-purpose` subagent at any time via the Task tool without you defining anything\n\nThis guide focuses on the programmatic approach, which is recommended for SDK applications.\n\nWhen you define subagents, Claude decides whether to invoke them based on each subagent's `description` field. Write clear descriptions that explain when the subagent should be used, and Claude will automatically delegate appropriate tasks. You can also explicitly request a subagent by name in your prompt (e.g., \"Use the code-reviewer agent to...\").\n\n## Benefits of using subagents\n\n### Context management\nSubagents maintain separate context from the main agent, preventing information overload and keeping interactions focused. This isolation ensures that specialized tasks don't pollute the main conversation context with irrelevant details.\n\n**Example**: a `research-assistant` subagent can explore dozens of files and documentation pages without cluttering the main conversation with all the intermediate search results, returning only the relevant findings.\n\n### Parallelization\nMultiple subagents can run concurrently, dramatically speeding up complex workflows.\n\n**Example**: during a code review, you can run `style-checker`, `security-scanner`, and `test-coverage` subagents simultaneously, reducing review time from minutes to seconds.\n\n### Specialized instructions and knowledge\nEach subagent can have tailored system prompts with specific expertise, best practices, and constraints.\n\n**Example**: a `database-migration` subagent can have detailed knowledge about SQL best practices, rollback strategies, and data integrity checks that would be unnecessary noise in the main agent's instructions.\n\n### Tool restrictions\nSubagents can be limited to specific tools, reducing the risk of unintended actions.\n\n**Example**: a `doc-reviewer` subagent might only have access to Read and Grep tools, ensuring it can analyze but never accidentally modify your documentation files.\n\n## Creating subagents\n\n### Programmatic definition (recommended)\n\nDefine subagents directly in your code using the `agents` parameter. This example creates two subagents: a code reviewer with read-only access and a test runner that can execute commands. The `Task` tool must be included in `allowedTools` since Claude invokes subagents through the Task tool.\n\n### AgentDefinition configuration\n\n| Field | Type | Required | Description |\n|:------|:-----|:---------|:------------|\n| `description` | `string` | Yes | Natural language description of when to use this agent |\n| `prompt` | `string` | Yes | The agent's system prompt defining its role and behavior |\n| `tools` | `string[]` | No | Array of allowed tool names. If omitted, inherits all tools |\n| `model` | `'sonnet' \\| 'opus' \\| 'haiku' \\| 'inherit'` | No | Model override for this agent. Defaults to main model if omitted |\n\n<Note>\nSubagents cannot spawn their own subagents. Don't include `Task` in a subagent's `tools` array.\n</Note>\n\n### Filesystem-based definition (alternative)\n\nYou can also define subagents as markdown files in `.claude/agents/` directories. See the [Claude Code subagents documentation](https://code.claude.com/docs/en/sub-agents) for details on this approach. Programmatically defined agents take precedence over filesystem-based agents with the same name.\n\n<Note>\nEven without defining custom subagents, Claude can spawn the built-in `general-purpose` subagent when `Task` is in your `allowedTools`. This is useful for delegating research or exploration tasks without creating specialized agents.\n</Note>\n\n## Invoking subagents\n\n### Automatic invocation\n\nClaude automatically decides when to invoke subagents based on the task and each subagent's `description`. For example, if you define a `performance-optimizer` subagent with the description \"Performance optimization specialist for query tuning\", Claude will invoke it when your prompt mentions optimizing queries.\n\nWrite clear, specific descriptions so Claude can match tasks to the right subagent.\n\n### Explicit invocation\n\nTo guarantee Claude uses a specific subagent, mention it by name in your prompt:\n\nThis bypasses automatic matching and directly invokes the named subagent.\n\n### Dynamic agent configuration\n\nYou can create agent definitions dynamically based on runtime conditions. This example creates a security reviewer with different strictness levels, using a more powerful model for strict reviews.\n\n<CodeGroup>\n```python Python\nimport asyncio\nfrom claude_agent_sdk import query, ClaudeAgentOptions, AgentDefinition",
  "code_samples": [
    {
      "code": "",
      "language": "unknown"
    },
    {
      "code": "</CodeGroup>\n\n### AgentDefinition configuration\n\n| Field | Type | Required | Description |\n|:------|:-----|:---------|:------------|\n| `description` | `string` | Yes | Natural language description of when to use this agent |\n| `prompt` | `string` | Yes | The agent's system prompt defining its role and behavior |\n| `tools` | `string[]` | No | Array of allowed tool names. If omitted, inherits all tools |\n| `model` | `'sonnet' \\| 'opus' \\| 'haiku' \\| 'inherit'` | No | Model override for this agent. Defaults to main model if omitted |\n\n<Note>\nSubagents cannot spawn their own subagents. Don't include `Task` in a subagent's `tools` array.\n</Note>\n\n### Filesystem-based definition (alternative)\n\nYou can also define subagents as markdown files in `.claude/agents/` directories. See the [Claude Code subagents documentation](https://code.claude.com/docs/en/sub-agents) for details on this approach. Programmatically defined agents take precedence over filesystem-based agents with the same name.\n\n<Note>\nEven without defining custom subagents, Claude can spawn the built-in `general-purpose` subagent when `Task` is in your `allowedTools`. This is useful for delegating research or exploration tasks without creating specialized agents.\n</Note>\n\n## Invoking subagents\n\n### Automatic invocation\n\nClaude automatically decides when to invoke subagents based on the task and each subagent's `description`. For example, if you define a `performance-optimizer` subagent with the description \"Performance optimization specialist for query tuning\", Claude will invoke it when your prompt mentions optimizing queries.\n\nWrite clear, specific descriptions so Claude can match tasks to the right subagent.\n\n### Explicit invocation\n\nTo guarantee Claude uses a specific subagent, mention it by name in your prompt:",
      "language": "unknown"
    },
    {
      "code": "This bypasses automatic matching and directly invokes the named subagent.\n\n### Dynamic agent configuration\n\nYou can create agent definitions dynamically based on runtime conditions. This example creates a security reviewer with different strictness levels, using a more powerful model for strict reviews.\n\n<CodeGroup>",
      "language": "unknown"
    }
  ],
  "headings": [
    {
      "level": "h2",
      "text": "Overview",
      "id": "overview"
    },
    {
      "level": "h2",
      "text": "Benefits of using subagents",
      "id": "benefits-of-using-subagents"
    },
    {
      "level": "h3",
      "text": "Context management",
      "id": "context-management"
    },
    {
      "level": "h3",
      "text": "Parallelization",
      "id": "parallelization"
    },
    {
      "level": "h3",
      "text": "Specialized instructions and knowledge",
      "id": "specialized-instructions-and-knowledge"
    },
    {
      "level": "h3",
      "text": "Tool restrictions",
      "id": "tool-restrictions"
    },
    {
      "level": "h2",
      "text": "Creating subagents",
      "id": "creating-subagents"
    },
    {
      "level": "h3",
      "text": "Programmatic definition (recommended)",
      "id": "programmatic-definition-(recommended)"
    },
    {
      "level": "h3",
      "text": "AgentDefinition configuration",
      "id": "agentdefinition-configuration"
    },
    {
      "level": "h3",
      "text": "Filesystem-based definition (alternative)",
      "id": "filesystem-based-definition-(alternative)"
    },
    {
      "level": "h2",
      "text": "Invoking subagents",
      "id": "invoking-subagents"
    },
    {
      "level": "h3",
      "text": "Automatic invocation",
      "id": "automatic-invocation"
    },
    {
      "level": "h3",
      "text": "Explicit invocation",
      "id": "explicit-invocation"
    },
    {
      "level": "h3",
      "text": "Dynamic agent configuration",
      "id": "dynamic-agent-configuration"
    }
  ],
  "url": "llms-txt#subagents-in-the-sdk",
  "links": []
}